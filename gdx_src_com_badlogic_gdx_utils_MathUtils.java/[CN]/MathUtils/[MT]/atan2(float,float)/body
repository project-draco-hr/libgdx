{
  float add, mul;
  if (x < 0) {
    if (y < 0) {
      y=-y;
      mul=1;
    }
 else     mul=-1;
    x=-x;
    add=-3.141592653f;
  }
 else {
    if (y < 0) {
      y=-y;
      mul=-1;
    }
 else     mul=1;
    add=0;
  }
  float invDiv=1 / ((x < y ? y : x) * INV_ATAN2_DIM_MINUS_1);
  int xi=(int)(x * invDiv);
  int yi=(int)(y * invDiv);
  return (atan2[yi * ATAN2_DIM + xi] + add) * mul;
}
