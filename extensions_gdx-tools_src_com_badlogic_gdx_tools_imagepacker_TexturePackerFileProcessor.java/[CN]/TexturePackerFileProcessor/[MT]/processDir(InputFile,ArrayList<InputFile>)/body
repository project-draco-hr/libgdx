{
  Settings settings=null;
  File parent=inputDir.inputFile;
  while (true) {
    if (parent.equals(root))     break;
    parent=parent.getParentFile();
    settings=dirToSettings.get(parent);
    if (settings != null) {
      settings=new Settings(settings);
      break;
    }
  }
  if (settings == null)   settings=new Settings(defaultSettings);
  dirToSettings.put(inputDir.inputFile,settings);
  File settingsFile=new File(inputDir.inputFile,"pack.json");
  if (settingsFile.exists())   json.readFields(settings,new JsonReader().parse(new FileReader(settingsFile)));
  TexturePacker2 packer=new TexturePacker2(root,settings);
  for (  InputFile file : files)   packer.addImage(file.inputFile);
  packer.pack(inputDir.outputDir,packFileName);
}
