{
  String file=null;
  if (app instanceof AndroidApplication)   file="/sdcard/audio/schism.mp3";
 else   file="data/threeofaperfectpair.mp3";
  Mpg123Decoder decoder=new Mpg123Decoder(file);
  ShortBuffer stereoSamples=AudioTools.allocateShortBuffer(1024,decoder.getNumChannels());
  ShortBuffer monoSamples=AudioTools.allocateShortBuffer(1024,1);
  FloatBuffer samples=AudioTools.allocateFloatBuffer(1024,1);
  FloatBuffer spectrum=AudioTools.allocateFloatBuffer(1024 / 2 + 1,1);
  NativeFFT fft=new NativeFFT(1024,decoder.getRate());
  app.log("Mpg123","rate: " + decoder.getRate() + ", channels: "+ decoder.getNumChannels()+ ", length: "+ decoder.getLength());
  long start=System.nanoTime();
  while (decoder.readSamples(decoder.handle,stereoSamples,stereoSamples.capacity()) > 0) {
    AudioTools.convertToMono(stereoSamples,monoSamples,stereoSamples.capacity());
    AudioTools.convertToFloat(monoSamples,samples,monoSamples.capacity());
    fft.spectrum(samples,spectrum,1024);
  }
  app.log("Mpg123","took " + (System.nanoTime() - start) / 1000000000.0);
  decoder.dispose();
}
