{
  graphics=new AndroidGraphics(this,config,config.resolutionStrategy == null ? new FillResolutionStrategy() : config.resolutionStrategy);
  input=AndroidInputFactory.newAndroidInput(this,this,graphics.view,config);
  audio=new AndroidAudio(this,config);
  files=new AndroidFiles(this.getAssets(),this.getFilesDir().getAbsolutePath());
  net=new AndroidNet(this);
  this.listener=listener;
  this.handler=new Handler();
  this.useImmersiveMode=config.useImmersiveMode;
  Gdx.app=this;
  Gdx.input=this.getInput();
  Gdx.audio=this.getAudio();
  Gdx.files=this.getFiles();
  Gdx.graphics=this.getGraphics();
  Gdx.net=this.getNet();
  createWakeLock(config);
  hideStatusBar(config);
  useImmersiveMode(this.useImmersiveMode);
  if (this.useImmersiveMode && getVersion() >= 19) {
    try {
      View rootView=getWindow().getDecorView();
      rootView.setOnSystemUiVisibilityChangeListener(new View.OnSystemUiVisibilityChangeListener(){
        @Override public void onSystemUiVisibilityChange(        int arg0){
          useImmersiveMode(useImmersiveMode);
        }
      }
);
    }
 catch (    Throwable t) {
      log("AndroidApplication","Can't create OnSystemUiVisibilityChangeListener",t);
    }
  }
  return graphics.getView();
}
