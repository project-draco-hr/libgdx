{
  float bounceX=bounceDistance / (widget.width - width);
  float bounceY=bounceDistance / (widget.height - height);
  if (flingTimer > 0) {
    float alpha=flingTimer / flingTime;
    alpha=alpha * alpha * alpha;
    hScrollAmount-=velocityX * alpha * delta;
    vScrollAmount+=velocityY * alpha * delta;
    clamp();
    if (hScrollAmount == -bounceX)     velocityX=0;
    if (hScrollAmount >= 1 + bounceX)     velocityX=0;
    if (vScrollAmount == -bounceY)     velocityY=0;
    if (vScrollAmount >= 1 + bounceY)     velocityY=0;
    flingTimer-=delta;
  }
  if (bounces && !gestureDetector.isPanning()) {
    if (hScrollAmount < 0) {
      float overscrollPercent=-hScrollAmount / bounceX;
      float bouncePixels=bounceSpeedMin + (bounceSpeedMax - bounceSpeedMin) * overscrollPercent;
      float bouncePercent=bouncePixels / (widget.width - width);
      hScrollAmount+=bouncePercent * delta;
      if (hScrollAmount > 0)       hScrollAmount=0;
    }
 else     if (hScrollAmount > 1) {
      float overscrollPercent=-(1 - hScrollAmount) / bounceX;
      float bouncePixels=bounceSpeedMin + (bounceSpeedMax - bounceSpeedMin) * overscrollPercent;
      float bouncePercent=bouncePixels / (widget.width - width);
      hScrollAmount-=bouncePercent * delta;
      if (hScrollAmount < 1)       hScrollAmount=1;
    }
    if (vScrollAmount < 0) {
      float overscrollPercent=-vScrollAmount / bounceY;
      float bouncePixels=bounceSpeedMin + (bounceSpeedMax - bounceSpeedMin) * overscrollPercent;
      float bouncePercent=bouncePixels / (widget.height - height);
      vScrollAmount+=bouncePercent * delta;
      if (vScrollAmount > 0)       vScrollAmount=0;
    }
 else     if (vScrollAmount > 1) {
      float overscrollPercent=-(1 - vScrollAmount) / bounceY;
      float bouncePixels=bounceSpeedMin + (bounceSpeedMax - bounceSpeedMin) * overscrollPercent;
      float bouncePercent=bouncePixels / (widget.height - height);
      vScrollAmount-=bouncePercent * delta;
      if (vScrollAmount < 1)       vScrollAmount=1;
    }
  }
}
