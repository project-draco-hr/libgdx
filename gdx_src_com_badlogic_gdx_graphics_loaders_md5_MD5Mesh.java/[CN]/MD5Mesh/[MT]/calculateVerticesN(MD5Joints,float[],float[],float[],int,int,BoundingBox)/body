{
  for (int vertexOffset=2, k=0; vertexOffset < vertices.length; vertexOffset+=vstride) {
    float finalX=0;
    float finalY=0;
    float finalZ=0;
    int weightOffset=(int)vertices[vertexOffset];
    int weightCount=(int)vertices[vertexOffset + 1];
    weightOffset=weightOffset * wstride;
    bn.set(vertices[vertexOffset + 2],vertices[vertexOffset + 3],vertices[vertexOffset + 4]);
    for (int j=0; j < weightCount; j++) {
      int jointOffset=(int)weights[weightOffset++] << 3;
      float bias=weights[weightOffset++];
      float vx=weights[weightOffset++];
      float vy=weights[weightOffset++];
      float vz=weights[weightOffset++];
      vn.set(weights[weightOffset++],weights[weightOffset++],weights[weightOffset++]);
      float qx=skeleton.joints[jointOffset + 4];
      float qy=skeleton.joints[jointOffset + 5];
      float qz=skeleton.joints[jointOffset + 6];
      float qw=skeleton.joints[jointOffset + 7];
      quat.x=qx;
      quat.y=qy;
      quat.z=qz;
      quat.w=qw;
      quat.rotate(vn);
      vn.mul(bias);
      bn.add(vn);
      float ix=-qx, iy=-qy, iz=-qz, iw=qw;
      float tw=-qx * vx - qy * vy - qz * vz;
      float tx=qw * vx + qy * vz - qz * vy;
      float ty=qw * vy + qz * vx - qx * vz;
      float tz=qw * vz + qx * vy - qy * vx;
      vx=tx * iw + tw * ix + ty * iz - tz * iy;
      vy=ty * iw + tw * iy + tz * ix - tx * iz;
      vz=tz * iw + tw * iz + tx * iy - ty * ix;
      finalX+=(skeleton.joints[jointOffset + 1] + vx) * bias;
      finalY+=(skeleton.joints[jointOffset + 2] + vy) * bias;
      finalZ+=(skeleton.joints[jointOffset + 3] + vz) * bias;
    }
    bbox.ext(finalX,finalY,finalZ);
    verts[k++]=finalX;
    verts[k++]=finalY;
    verts[k++]=finalZ;
    k+=2;
    bn.nor();
    verts[k++]=bn.x;
    verts[k++]=bn.y;
    verts[k++]=bn.z;
  }
}
