{
  final int action=event.getAction() & MotionEvent.ACTION_MASK;
  int pointerIndex=(event.getAction() & MotionEvent.ACTION_POINTER_ID_MASK) >> MotionEvent.ACTION_POINTER_ID_SHIFT;
  int pointerId=event.getPointerId(pointerIndex);
  int x=0, y=0;
switch (action) {
case MotionEvent.ACTION_DOWN:
case MotionEvent.ACTION_POINTER_DOWN:
    x=(int)event.getX(pointerIndex);
  y=(int)event.getY(pointerIndex);
postTouchEvent(input,TouchEvent.TOUCH_DOWN,x,y,pointerId);
input.touchX[pointerId]=x;
input.touchY[pointerId]=y;
input.touched[pointerId]=true;
break;
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_POINTER_UP:
case MotionEvent.ACTION_OUTSIDE:
case MotionEvent.ACTION_CANCEL:
x=(int)event.getX(pointerIndex);
y=(int)event.getY(pointerIndex);
postTouchEvent(input,TouchEvent.TOUCH_UP,x,y,pointerId);
input.touchX[pointerId]=x;
input.touchY[pointerId]=y;
input.touched[pointerId]=false;
break;
case MotionEvent.ACTION_MOVE:
int pointerCount=event.getPointerCount();
for (int i=0; i < pointerCount; i++) {
pointerIndex=i;
pointerId=event.getPointerId(pointerIndex);
x=(int)event.getX(pointerIndex);
y=(int)event.getY(pointerIndex);
postTouchEvent(input,TouchEvent.TOUCH_DRAGGED,x,y,pointerId);
input.touchX[pointerId]=x;
input.touchY[pointerId]=y;
}
break;
}
}
