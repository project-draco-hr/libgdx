{
  assetManager=manager;
  try {
    XmlReader reader=new XmlReader();
    Element root=reader.parse(Gdx.files.internal(fileName));
    if (map == null) {
      map=new Map();
      loadProperties(root,map.getProperties());
    }
    if (!atlasFile.isEmpty()) {
      atlas=manager.get(atlasFile,TextureAtlas.class);
    }
    Array<Element> layerElements=root.getChildByName("Layers").getChildrenByName("Layer");
    for (int i=0; i < layerElements.size; ++i) {
      Element layerElement=layerElements.get(i);
      loadLayer(layerElement);
    }
  }
 catch (  Exception e) {
    throw new GdxRuntimeException("Couldn't load Gleed map '" + fileName + "'",e);
  }
}
