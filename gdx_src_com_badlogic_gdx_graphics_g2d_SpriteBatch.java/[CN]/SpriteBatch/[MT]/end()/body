{
  if (!drawing)   throw new IllegalStateException("SpriteBatch.begin must be called before end.");
  if (idx > 0)   renderMesh();
  lastTexture=null;
  idx=0;
  drawing=false;
  GLCommon gl=Gdx.gl;
  gl.glDepthMask(true);
  if (isBlendingEnabled())   gl.glDisable(GL10.GL_BLEND);
  gl.glDisable(GL10.GL_TEXTURE_2D);
  if (Gdx.graphics.isGL20Available()) {
    shader.end();
  }
}
