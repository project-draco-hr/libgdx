{
  float n_x=mouse_x - screen_width / 2.0f;
  float n_y=mouse_y - screen_height / 2.0f;
  n_x/=screen_width / 2.0f;
  n_y/=screen_height / 2.0f;
  Z.set(dir.tmp().mul(-1)).nor();
  X.set(up.tmp().crs(Z)).nor();
  Y.set(Z.tmp().crs(X)).nor();
  near_center.set(pos.tmp3().sub(Z.tmp2().mul(near)));
  Vector near_point=X.tmp3().mul(near_width).mul(n_x).add(Y.tmp2().mul(near_height).mul(n_y));
  near_point.add(near_center);
  return ray.set(near_point.tmp(),near_point.sub(pos).nor());
}
