{
  if (data instanceof byte[]) {
    byte[] b=new byte[length];
    getBytes(0,length,b,0);
    return b;
  }
  String fmt=format.trim().toUpperCase();
  if (DEFAULT_ENCODING.equals(fmt)) {
    return Utf8.encode((char[])data,offset,length);
  }
 else   if (ISO_8859_1_ENCODING.equals(fmt) || LATIN_1_ENCODING.equals(fmt)) {
    return Iso88591.encode((char[])data,offset,length);
  }
 else {
    throw new java.io.UnsupportedEncodingException("Encoding " + format + " not supported");
  }
}
