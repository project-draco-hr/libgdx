{
  if (previousPageRequested) {
    previousPageRequested=false;
    index=index - 1 < 0 ? sprites.size() - 1 : index - 1;
  }
  if (nextPageRequested) {
    nextPageRequested=false;
    index=index + 1 >= sprites.size() ? 0 : index + 1;
  }
  if (packReloadRequested) {
    packReloadRequested=false;
    index=0;
    camera.position.set(0,0,0);
    camera.update();
    sprites.clear();
    if (atlas != null)     atlas.dispose();
    if (packFile != null && packFile.exists()) {
      try {
        atlas=new TextureAtlas(packFile);
        List<Texture> textures=new ArrayList<Texture>();
        for (        AtlasRegion region : atlas.getRegions()) {
          if (!textures.contains(region.getTexture()))           textures.add(region.getTexture());
        }
        for (        Texture tex : textures) {
          Sprite sp=new Sprite(tex);
          sp.setOrigin(sp.getWidth() / 2,sp.getHeight() / 2);
          sp.setPosition(-sp.getOriginX(),-sp.getOriginY());
          sprites.add(sp);
        }
      }
 catch (      GdxRuntimeException ex) {
        atlas=null;
        sprites.clear();
        callback.atlasError();
      }
    }
  }
  Gdx.gl.glClearColor(1,1,1,1);
  Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);
  float w=Gdx.graphics.getWidth();
  float h=Gdx.graphics.getHeight();
  float tw=bgTex.getWidth();
  float th=bgTex.getHeight();
  batch.getProjectionMatrix().setToOrtho2D(0,0,w,h);
  batch.begin();
  batch.disableBlending();
  batch.draw(bgTex,0f,0f,w,h,0f,0f,w / tw,h / th);
  batch.enableBlending();
  batch.end();
  batch.setProjectionMatrix(camera.combined);
  batch.begin();
  if (!sprites.isEmpty())   sprites.get(index).draw(batch);
  batch.end();
  batch.getProjectionMatrix().setToOrtho2D(0,0,w,h);
  batch.begin();
  font.setColor(Color.WHITE);
  lblNextPage.draw(batch);
  lblPreviousPage.draw(batch);
  infoLabel.draw(batch);
  if (sprites.isEmpty())   font.draw(batch,"No page to show",10,65);
 else   font.draw(batch,"Page " + (index + 1) + " / "+ sprites.size(),10,65);
  font.draw(batch,String.format(Locale.US,"Zoom: %.0f %%",100f / camera.zoom),10,45);
  font.draw(batch,"Fps: " + Gdx.graphics.getFramesPerSecond(),10,25);
  batch.end();
}
