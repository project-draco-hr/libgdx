{
  if (initialCapacity < 0)   throw new IllegalArgumentException("initialCapacity must be >= 0: " + initialCapacity);
  if (capacity > 1 << 30)   throw new IllegalArgumentException("initialCapacity is too large: " + initialCapacity);
  capacity=MathUtils.nextPowerOfTwo(initialCapacity);
  if (loadFactor <= 0)   throw new IllegalArgumentException("loadFactor must be > 0: " + loadFactor);
  this.loadFactor=loadFactor;
  threshold=(int)(capacity * loadFactor);
  mask=capacity - 1;
  hashShift=31 - Integer.numberOfTrailingZeros(capacity);
  stashCapacity=Math.max(3,(int)Math.ceil(Math.log(capacity)) + 1);
  pushIterations=Math.max(Math.min(capacity,32),(int)Math.sqrt(capacity) / 4);
  keyTable=(K[])new Object[capacity + stashCapacity];
  valueTable=new int[keyTable.length];
}
