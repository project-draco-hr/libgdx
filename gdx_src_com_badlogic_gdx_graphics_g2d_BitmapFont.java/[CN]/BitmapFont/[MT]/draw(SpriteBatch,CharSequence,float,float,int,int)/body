{
  float batchColor=spriteBatch.color;
  spriteBatch.setColor(color);
  final Texture texture=region.getTexture();
  y+=data.ascent;
  float startX=x;
  Glyph lastGlyph=null;
  if (data.scaleX == 1 && data.scaleY == 1) {
    if (integer) {
      y=(int)y;
      x=(int)x;
    }
    while (start < end) {
      lastGlyph=data.getGlyph(str.charAt(start++));
      if (lastGlyph != null) {
        spriteBatch.draw(texture,x + lastGlyph.xoffset,y + lastGlyph.yoffset,lastGlyph.width,lastGlyph.height,lastGlyph.u,lastGlyph.v,lastGlyph.u2,lastGlyph.v2);
        x+=lastGlyph.xadvance;
        break;
      }
    }
    while (start < end) {
      char ch=str.charAt(start++);
      Glyph g=data.getGlyph(ch);
      if (g == null)       continue;
      x+=lastGlyph.getKerning(ch);
      if (integer)       x=(int)x;
      lastGlyph=g;
      spriteBatch.draw(texture,x + lastGlyph.xoffset,y + lastGlyph.yoffset,lastGlyph.width,lastGlyph.height,lastGlyph.u,lastGlyph.v,lastGlyph.u2,lastGlyph.v2);
      x+=g.xadvance;
    }
  }
 else {
    float scaleX=this.data.scaleX, scaleY=this.data.scaleY;
    while (start < end) {
      lastGlyph=data.getGlyph(str.charAt(start++));
      if (lastGlyph != null) {
        if (!integer) {
          spriteBatch.draw(texture,x + lastGlyph.xoffset * scaleX,y + lastGlyph.yoffset * scaleY,lastGlyph.width * scaleX,lastGlyph.height * scaleY,lastGlyph.u,lastGlyph.v,lastGlyph.u2,lastGlyph.v2);
        }
 else {
          spriteBatch.draw(texture,(int)(x + lastGlyph.xoffset * scaleX),(int)(y + lastGlyph.yoffset * scaleY),(int)(lastGlyph.width * scaleX),(int)(lastGlyph.height * scaleY),lastGlyph.u,lastGlyph.v,lastGlyph.u2,lastGlyph.v2);
        }
        x+=lastGlyph.xadvance * scaleX;
        break;
      }
    }
    while (start < end) {
      char ch=str.charAt(start++);
      Glyph g=data.getGlyph(ch);
      if (g == null)       continue;
      x+=lastGlyph.getKerning(ch) * scaleX;
      lastGlyph=g;
      if (!integer) {
        spriteBatch.draw(texture,x + lastGlyph.xoffset * scaleX,y + lastGlyph.yoffset * scaleY,lastGlyph.width * scaleX,lastGlyph.height * scaleY,lastGlyph.u,lastGlyph.v,lastGlyph.u2,lastGlyph.v2);
      }
 else {
        spriteBatch.draw(texture,(int)(x + lastGlyph.xoffset * scaleX),(int)(y + lastGlyph.yoffset * scaleY),(int)(lastGlyph.width * scaleX),(int)(lastGlyph.height * scaleY),lastGlyph.u,lastGlyph.v,lastGlyph.u2,lastGlyph.v2);
      }
      x+=g.xadvance * scaleX;
    }
  }
  spriteBatch.setColor(batchColor);
  textBounds.width=x - startX;
  textBounds.height=data.capHeight;
  return textBounds;
}
