{
  StringBuilder buffer=new StringBuilder();
  for (int i=0; i < text.length(); i++) {
    char c=text.charAt(i);
    buffer.append(style.font.containsCharacter(c) ? c : ' ');
  }
  String text=buffer.toString();
  if (passwordMode && style.font.containsCharacter(passwordCharacter)) {
    if (passwordBuffer == null)     passwordBuffer=new StringBuilder(text.length());
    if (passwordBuffer.length() > text.length())     passwordBuffer.setLength(text.length());
 else {
      for (int i=passwordBuffer.length(), n=text.length(); i < n; i++)       passwordBuffer.append(passwordCharacter);
    }
    displayText=passwordBuffer;
  }
 else   displayText=text;
  style.font.computeGlyphAdvancesAndPositions(displayText,glyphAdvances,glyphPositions);
  if (selectionStart > text.length())   selectionStart=text.length();
}
