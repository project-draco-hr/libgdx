{
  if (lastKeyCharPressed != 0) {
    keyRepeatTimer-=Gdx.graphics.getDeltaTime();
    if (keyRepeatTimer < 0) {
      keyRepeatTimer=0.15f;
      KeyEvent event=usedKeyEvents.obtain();
      event.keyCode=0;
      event.keyChar=lastKeyCharPressed;
      event.type=KeyEvent.KEY_TYPED;
      event.timeStamp=System.nanoTime();
      keyEvents.add(event);
    }
  }
  if (Keyboard.isCreated()) {
    while (Keyboard.next()) {
      if (Keyboard.getEventKeyState()) {
        int keyCode=getGdxKeyCode(Keyboard.getEventKey());
        char keyChar=Keyboard.getEventCharacter();
        long timeStamp=Keyboard.getEventNanoseconds();
switch (keyCode) {
case Keys.FORWARD_DEL:
          keyChar=127;
        break;
    }
    KeyEvent event=usedKeyEvents.obtain();
    event.keyCode=keyCode;
    event.keyChar=0;
    event.type=KeyEvent.KEY_DOWN;
    event.timeStamp=timeStamp;
    keyEvents.add(event);
    event=usedKeyEvents.obtain();
    event.keyCode=0;
    event.keyChar=keyChar;
    event.type=KeyEvent.KEY_TYPED;
    event.timeStamp=timeStamp;
    keyEvents.add(event);
    pressedKeys++;
    lastKeyCharPressed=keyChar;
    keyRepeatTimer=0.4f;
  }
 else {
    int keyCode=LwjglInput.getGdxKeyCode(Keyboard.getEventKey());
    KeyEvent event=usedKeyEvents.obtain();
    event.keyCode=keyCode;
    event.keyChar=0;
    event.type=KeyEvent.KEY_UP;
    event.timeStamp=Keyboard.getEventNanoseconds();
    keyEvents.add(event);
    pressedKeys--;
    lastKeyCharPressed=0;
  }
}
}
}
