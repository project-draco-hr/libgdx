{
  float rotation=getRotation();
  float scaleX=getScaleX();
  float scaleY=getScaleY();
  float childX=getX();
  float childY=getY();
  if (rotation == 0) {
    if (scaleX == 1 && scaleY == 1) {
      parentCoords.x-=childX;
      parentCoords.y-=childY;
    }
 else {
      float originX=getOriginX();
      float originY=getOriginY();
      if (originX == 0 && originY == 0) {
        parentCoords.x=(parentCoords.x - childX) / scaleX;
        parentCoords.y=(parentCoords.y - childY) / scaleY;
      }
 else {
        parentCoords.x=(parentCoords.x - childX - originX) / scaleX + originX;
        parentCoords.y=(parentCoords.y - childY - originY) / scaleY + originY;
      }
    }
  }
 else {
    final float cos=(float)Math.cos(rotation * MathUtils.degreesToRadians);
    final float sin=(float)Math.sin(rotation * MathUtils.degreesToRadians);
    float originX=getOriginX();
    float originY=getOriginY();
    if (scaleX == 1 && scaleY == 1) {
      if (originX == 0 && originY == 0) {
        float tox=parentCoords.x - childX;
        float toy=parentCoords.y - childY;
        parentCoords.x=tox * cos + toy * sin;
        parentCoords.y=tox * -sin + toy * cos;
      }
 else {
        final float worldOriginX=childX + originX;
        final float worldOriginY=childY + originY;
        float fx=-originX;
        float fy=-originY;
        float x1=cos * fx - sin * fy;
        float y1=sin * fx + cos * fy;
        x1+=worldOriginX;
        y1+=worldOriginY;
        float tox=parentCoords.x - x1;
        float toy=parentCoords.y - y1;
        parentCoords.x=tox * cos + toy * sin;
        parentCoords.y=tox * -sin + toy * cos;
      }
    }
 else {
      if (originX == 0 && originY == 0) {
        float tox=parentCoords.x - childX;
        float toy=parentCoords.y - childY;
        parentCoords.x=tox * cos + toy * sin;
        parentCoords.y=tox * -sin + toy * cos;
        parentCoords.x/=scaleX;
        parentCoords.y/=scaleY;
      }
 else {
        final float worldOriginX=childX + originX;
        final float worldOriginY=childY + originY;
        float fx=-originX * scaleX;
        float fy=-originY * scaleY;
        float x1=cos * fx - sin * fy;
        float y1=sin * fx + cos * fy;
        x1+=worldOriginX;
        y1+=worldOriginY;
        float tox=parentCoords.x - x1;
        float toy=parentCoords.y - y1;
        parentCoords.x=tox * cos + toy * sin;
        parentCoords.y=tox * -sin + toy * cos;
        parentCoords.x/=scaleX;
        parentCoords.y/=scaleY;
      }
    }
  }
}
