{
  if (mCurrentAnim != null) {
    mAnimPos+=dt;
    if (mAnimPos > mAnimLen) {
      if (mAnimLoop) {
        mAnimPos=0.f;
      }
 else {
        mAnimPos=mAnimLen;
      }
    }
    float animPos=mAnimPos / mAnimLen;
    int numFrames=mCurrentAnim.getNumFrames();
    int currentFrameIdx=Math.min(numFrames - 1,(int)(animPos * (float)numFrames));
    if (currentFrameIdx != mCurrentFrameIdx) {
      if (currentFrameIdx < numFrames - 1) {
        mNextFrameIdx=currentFrameIdx + 1;
      }
 else {
        if (mAnimLoop) {
          mNextFrameIdx=0;
        }
 else {
          mNextFrameIdx=currentFrameIdx;
        }
      }
      mFrameDelta=0.f;
      mCurrentFrameIdx=currentFrameIdx;
    }
    mFrameDelta+=dt;
    setInterpolationFrames();
    interpolate();
  }
}
