{
  int tile;
  AtlasRegion region;
  cache.beginCache();
  int firstCol=blockCol * tilesPerBlockX;
  int firstRow=blockRow * tilesPerBlockY;
  int lastCol=firstCol + tilesPerBlockX;
  int lastRow=firstRow + tilesPerBlockY;
  int row, col;
  float x, y;
  for (row=firstRow; row < lastRow && row < layer.length; row++) {
    for (col=firstCol; col < lastCol && col < layer[row].length; col++) {
      tile=layer[row][col];
      if (tile != 0) {
        if (blended == blendedTiles.contains(tile)) {
          region=atlas.getRegion(tile);
          if (region != null) {
            cache.add(region,col * unitsPerTileX,((layer.length - row)) * unitsPerTileY,(float)region.offsetX * unitsPerTileX / tileWidth,-(float)(region.packedHeight + region.offsetY) * unitsPerTileY / tileHeight,region.packedWidth,region.packedHeight,unitsPerTileX / tileWidth,unitsPerTileY / tileHeight,(region.rotate) ? 90 : 0);
          }
        }
      }
    }
  }
  return cache.endCache();
}
