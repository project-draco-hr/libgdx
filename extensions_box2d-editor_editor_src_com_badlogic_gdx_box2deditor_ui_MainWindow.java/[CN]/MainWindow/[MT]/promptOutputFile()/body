{
  File outputFile=AppContext.instance().outputFile;
  File startupDir=outputFile != null ? outputFile.getParentFile() : new File(".");
  if (!startupDir.isDirectory())   startupDir=new File(".");
  JFileChooser chooser=new JFileChooser(startupDir);
  chooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
  chooser.setMultiSelectionEnabled(false);
  if (chooser.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
    File selectedFile=chooser.getSelectedFile();
    return selectedFile;
  }
  return null;
}
