{
  int count=0;
  if (hasSavedChar && length > 0) {
    length--;
    b[offset++]=savedChar;
    hasSavedChar=false;
    count=1;
  }
  if (length > 0) {
    int c=in.read(b,offset,length);
    if (c == -1) {
      if (count == 0) {
        count=-1;
      }
    }
 else {
      count+=c;
    }
  }
  return count;
}
