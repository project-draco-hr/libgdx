{
  outputDir.mkdirs();
  if (packFileName.indexOf('.') == -1)   packFileName+=settings.jsonOutput ? ".json" : ".atlas";
  Array<Page> pages=maxRectsPacker.pack(imageProcessor.getImages());
  writeImages(outputDir,pages,packFileName);
  try {
    writePackFile(outputDir,pages,packFileName);
  }
 catch (  IOException ex) {
    throw new RuntimeException("Error writing pack file.",ex);
  }
}
