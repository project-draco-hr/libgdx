{
  final int width=bitmap[0].length;
  final int height=bitmap.length;
  final boolean base=bitmap[pointY][pointX];
  int maxDist=upscale * spread;
  final int startX=Math.max(0,pointX - maxDist);
  final int endX=Math.min(width - 1,pointX + maxDist);
  final int startY=Math.max(0,pointY - maxDist);
  final int endY=Math.min(height - 1,pointY + maxDist);
  int closestSquareDist=maxDist * maxDist;
  for (int y=startY; y <= endY; ++y) {
    for (int x=startX; x <= endX; ++x) {
      if (base != bitmap[y][x]) {
        final int squareDist=squareDist(pointX,pointY,x,y);
        if (squareDist < closestSquareDist) {
          closestSquareDist=squareDist;
        }
      }
    }
  }
  float closestDist=(float)Math.sqrt(closestSquareDist);
  return (base ? 1 : -1) * closestDist / upscale;
}
