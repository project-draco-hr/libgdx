{
  parentAlpha*=getColor().a;
  SnapshotArray<Actor> children=this.children;
  children.begin();
  if (cullingArea != null) {
    if (transform) {
      for (int i=0, n=children.size; i < n; i++) {
        Actor child=children.get(i);
        if (!child.isVisible())         continue;
        float x=child.getX();
        float y=child.getY();
        if (x <= cullingArea.x + cullingArea.width && y <= cullingArea.y + cullingArea.height && x + child.getWidth() >= cullingArea.x && y + child.getHeight() >= cullingArea.y) {
          child.draw(batch,parentAlpha);
        }
      }
      batch.flush();
    }
 else {
      float offsetX=getX();
      float offsetY=getY();
      setPosition(0,0);
      for (int i=0, n=children.size; i < n; i++) {
        Actor child=children.get(i);
        if (!child.isVisible())         continue;
        float x=child.getX();
        float y=child.getY();
        if (x <= cullingArea.x + cullingArea.width && y <= cullingArea.y + cullingArea.height && x + child.getWidth() >= cullingArea.x && y + child.getHeight() >= cullingArea.y) {
          child.translate(offsetX,offsetY);
          child.draw(batch,parentAlpha);
          child.setPosition(x,y);
        }
      }
      setPosition(offsetX,offsetY);
    }
  }
 else {
    if (transform) {
      for (int i=0, n=children.size; i < n; i++) {
        Actor child=children.get(i);
        if (!child.isVisible())         continue;
        child.draw(batch,parentAlpha);
      }
      batch.flush();
    }
 else {
      float offsetX=getX();
      float offsetY=getY();
      setPosition(0,0);
      for (int i=0, n=children.size; i < n; i++) {
        Actor child=children.get(i);
        if (!child.isVisible())         continue;
        float x=child.getX();
        float y=child.getY();
        child.translate(offsetX,offsetY);
        child.draw(batch,parentAlpha);
        child.setPosition(x,y);
      }
      setPosition(offsetX,offsetY);
    }
  }
  children.end();
}
