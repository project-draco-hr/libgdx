{
  if (child.rotation == 0) {
    if (child.scaleX == 1 && child.scaleY == 1) {
      out.x=x - child.x;
      out.y=y - child.y;
    }
 else {
      if (child.originX == 0 && child.originY == 0) {
        out.x=(x - child.x) / child.scaleX;
        out.y=(y - child.y) / child.scaleY;
      }
 else {
        out.x=x / child.scaleX - (child.x - child.originX);
        out.x=x / child.scaleX - (child.x - child.originX);
      }
    }
  }
 else {
    final float cos=(float)Math.cos((float)Math.toRadians(child.rotation));
    final float sin=(float)Math.sin((float)Math.toRadians(child.rotation));
    if (child.scaleX == 1 && child.scaleY == 1) {
      if (child.originX == 0 && child.originY == 0) {
        float tox=x - child.x;
        float toy=y - child.y;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
      }
 else {
        float refX=-sin * child.originX + cos * child.originY;
        float refY=cos * child.originX + sin * child.originY;
        float px=child.x + child.originX - refX;
        float py=child.y + child.originY - refY;
        float tox=x - px;
        float toy=y - py;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
      }
    }
 else {
      if (child.originX == 0 && child.originY == 0) {
        float tox=x - child.x;
        float toy=y - child.y;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
        out.x/=child.scaleX;
        out.y/=child.scaleY;
      }
 else {
        float srefX=child.originX * child.scaleY;
        float srefY=child.originY * child.scaleX;
        float refX=-sin * srefX + cos * srefY;
        float refY=cos * srefX + sin * srefY;
        float px=child.x + child.originX - refX;
        float py=child.y + child.originY - refY;
        float tox=x - px;
        float toy=y - py;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
        out.x/=child.scaleX;
        out.y/=child.scaleY;
      }
    }
  }
}
