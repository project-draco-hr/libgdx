{
  if (child.rotation == 0) {
    if (child.scaleX == 1 && child.scaleY == 1) {
      out.x=x - child.x;
      out.y=y - child.y;
    }
 else {
      if (child.originX == 0 && child.originY == 0) {
        out.x=(x - child.x) / child.scaleX;
        out.y=(y - child.y) / child.scaleY;
      }
 else {
        out.x=x / child.scaleX - (child.x - child.originX);
        out.x=x / child.scaleX - (child.x - child.originX);
      }
    }
  }
 else {
    final float cos=(float)Math.cos((float)Math.toRadians(child.rotation));
    final float sin=(float)Math.sin((float)Math.toRadians(child.rotation));
    if (child.scaleX == 1 && child.scaleY == 1) {
      if (child.originX == 0 && child.originY == 0) {
        float tox=x - child.x;
        float toy=y - child.y;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
      }
 else {
        final float worldOriginX=child.x + child.originX;
        final float worldOriginY=child.y + child.originY;
        float fx=-child.originX;
        float fy=-child.originY;
        float x1=cos * fx - sin * fy;
        float y1=sin * fx + cos * fy;
        x1+=worldOriginX;
        y1+=worldOriginY;
        float tox=x - x1;
        float toy=y - y1;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
      }
    }
 else {
      if (child.originX == 0 && child.originY == 0) {
        float tox=x - child.x;
        float toy=y - child.y;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
        out.x/=child.scaleX;
        out.y/=child.scaleY;
      }
 else {
        float srefX=child.originX * child.scaleX;
        float srefY=child.originY * child.scaleY;
        final float worldOriginX=child.x + srefX;
        final float worldOriginY=child.y + srefY;
        float fx=-srefX;
        float fy=-srefY;
        float x1=cos * fx - sin * fy;
        float y1=sin * fx + cos * fy;
        x1+=worldOriginX;
        y1+=worldOriginY;
        float tox=x - x1;
        float toy=y - y1;
        out.x=tox * cos + toy * sin;
        out.y=tox * -sin + toy * cos;
        out.x/=child.scaleX;
        out.y/=child.scaleY;
      }
    }
  }
}
