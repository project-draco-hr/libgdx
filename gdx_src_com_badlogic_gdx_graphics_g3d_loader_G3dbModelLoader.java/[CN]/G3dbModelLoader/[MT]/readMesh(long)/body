{
  long cnt=0;
  final ModelMesh mesh=new ModelMesh();
  final Array<ModelMeshPart> parts=new Array<ModelMeshPart>();
  while ((din.available() > 0) && (cnt < length)) {
    final byte type=din.readByte();
    final long size=readSize(type);
    cnt+=1 + getSize(type) + size;
    if ((type & TYPE_MASK) == G3DB_TAG_ID)     mesh.id=readString(size);
 else     if ((type & TYPE_MASK) == G3DB_TAG_ATTRIBUTES)     mesh.attributes=readAttributes(size);
 else     if ((type & TYPE_MASK) == G3DB_TAG_VERTICES)     mesh.vertices=readVertices(size);
 else     if ((type & TYPE_MASK) == G3DB_TAG_MESHPART)     parts.add(readMeshPart(size));
 else {
      din.skipBytes((int)size);
      Gdx.app.log("G3dbModelLoader","Unknown mesh tag: " + type + "["+ size+ "], skipping");
    }
  }
  mesh.parts=new ModelMeshPart[parts.size];
  for (int i=0; i < parts.size; i++)   mesh.parts[i]=parts.get(i);
  return mesh;
}
