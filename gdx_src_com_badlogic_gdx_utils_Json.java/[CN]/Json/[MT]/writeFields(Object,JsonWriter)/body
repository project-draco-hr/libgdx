{
  ObjectMap<String,Field> fields=typeToFields.get(object.getClass());
  if (fields == null)   fields=cacheFields(object.getClass());
  for (  Field valueField : fields.values()) {
    try {
      if (debug)       System.out.println("Writing field: " + valueField.getName() + " ("+ object.getClass().getName()+ ")");
      writeValue(valueField.getName(),valueField.get(object),valueField.getType(),writer);
    }
 catch (    IllegalAccessException ex) {
      throw new SerializationException("Error accessing field: " + valueField.getName() + " ("+ object.getClass().getName()+ ")",ex);
    }
catch (    SerializationException ex) {
      ex.addTrace(valueField + " (" + object.getClass().getName()+ ")");
      throw ex;
    }
catch (    RuntimeException runtimeEx) {
      SerializationException ex=new SerializationException(runtimeEx);
      ex.addTrace(valueField + " (" + object.getClass().getName()+ ")");
      throw ex;
    }
  }
}
