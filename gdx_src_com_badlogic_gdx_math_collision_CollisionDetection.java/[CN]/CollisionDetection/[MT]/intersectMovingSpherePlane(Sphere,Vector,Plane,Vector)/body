{
  float dist=p.normal.dot(s.center) - p.d;
  if (Math.abs(dist) <= s.radius) {
    i.set(s.center);
    return true;
  }
 else {
    float denom=p.normal.dot(v);
    if (denom * dist >= 0) {
      return false;
    }
 else {
      float r=dist > 0 ? s.radius : -s.radius;
      float t=(r - dist) / denom;
      if (t < 0 || t > 1)       return false;
      i.set(s.center).add(v.tmp().mul(t)).sub(p.normal.tmp().mul(r));
      return true;
    }
  }
}
