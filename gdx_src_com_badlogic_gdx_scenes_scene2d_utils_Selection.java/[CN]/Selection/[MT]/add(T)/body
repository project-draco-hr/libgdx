{
  if (!selected.add(item))   return;
  if (programmaticChangeEvents && fireChangeEvent())   selected.remove(item);
 else   lastSelected=item;
}
