{
synchronized (this) {
    if (!hasXmlHeader) {
      out.println("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
      out.println("<java version=\"" + System.getProperty("java.version") + "\" class=\"com.esotericsoftware.android.beans.XMLDecoder\">");
      hasXmlHeader=true;
    }
    for (Iterator<Object> iter=flushPending.iterator(); iter.hasNext(); ) {
      Object o=iter.next();
      Record rec=objRecordMap.get(o);
      if (rec != null) {
        preprocess(o,rec);
      }
    }
    for (Iterator<Object> iter=flushPending.iterator(); iter.hasNext(); ) {
      Object o=iter.next();
      flushObject(o,INDENT_UNIT);
      iter.remove();
    }
    objRecordMap.clear();
    flushPendingStat.clear();
    objPrePendingCache.clear();
    clazzCounterMap.clear();
    super.clear();
  }
}
