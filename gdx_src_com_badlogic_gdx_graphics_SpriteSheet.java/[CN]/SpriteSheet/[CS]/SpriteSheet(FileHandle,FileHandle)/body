{
  PriorityQueue<PackedSprite> sortedSprites=new PriorityQueue(16,indexComparator);
  BufferedReader reader=new BufferedReader(new InputStreamReader(packFile.read()),64);
  try {
    Sprite pageImage=null;
    while (true) {
      String line=reader.readLine();
      if (line == null)       break;
      if (line.trim().length() == 0)       pageImage=null;
 else       if (pageImage == null) {
        FileHandle file=imagesDir.child(line);
        String direction=reader.readLine();
        TextureWrap wrapX=ClampToEdge;
        TextureWrap wrapY=ClampToEdge;
        if (direction.equals("x"))         wrapX=Repeat;
 else         if (direction.equals("y"))         wrapY=Repeat;
 else         if (direction.equals("xy")) {
          wrapX=Repeat;
          wrapY=Repeat;
        }
        Texture texture=Gdx.graphics.newTexture(file,Linear,Linear,ClampToEdge,ClampToEdge);
        textures.add(texture);
        pageImage=new Sprite(texture);
      }
 else {
        int left=Integer.parseInt(reader.readLine());
        int top=Integer.parseInt(reader.readLine());
        int width=Integer.parseInt(reader.readLine());
        int height=Integer.parseInt(reader.readLine());
        int offsetX=Integer.parseInt(reader.readLine());
        int offsetY=Integer.parseInt(reader.readLine());
        int originalWidth=Integer.parseInt(reader.readLine());
        int originalHeight=Integer.parseInt(reader.readLine());
        PackedSprite image=new PackedSprite(pageImage,left,top,width,height);
        image.setPosition(offsetX,offsetY);
        image.name=line;
        image.offsetX=offsetX;
        image.offsetY=offsetY;
        image.originalWidth=originalWidth;
        image.originalHeight=originalHeight;
        image.index=Integer.parseInt(reader.readLine());
        if (image.index == -1)         image.index=Integer.MAX_VALUE;
        sortedSprites.add(image);
      }
    }
  }
 catch (  IOException ex) {
    throw new GdxRuntimeException("Error reading pack file: " + packFile);
  }
 finally {
    try {
      reader.close();
    }
 catch (    IOException ignored) {
    }
  }
  int n=sortedSprites.size();
  images=new PackedSprite[n];
  for (int i=0; i < n; i++)   images[i]=sortedSprites.poll();
}
