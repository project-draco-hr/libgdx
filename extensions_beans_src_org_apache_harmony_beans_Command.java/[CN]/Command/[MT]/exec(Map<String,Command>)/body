{
  if (status < Command.CHILDREN_PROCESSED) {
    if (status < Command.COMMAND_EXECUTED) {
      if (status < Command.CHILDREN_FILTERED) {
        status=doBeforeRun(references);
      }
      if (status == Command.CHILDREN_FILTERED) {
        status=doRun(references);
      }
    }
    if (status == Command.COMMAND_EXECUTED) {
      status=doAfterRun(references);
    }
  }
  return status;
}
