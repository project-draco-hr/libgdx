{
  Gdx.gl.glViewport(0,0,Gdx.graphics.getWidth(),Gdx.graphics.getHeight());
  Gdx.gl.glClearColor(0.2f,0.2f,0.2f,1);
  Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);
  if (Gdx.input.isTouched()) {
    Vector2 stageCoords=stage.toStageCoordinates(Gdx.input.getX(),Gdx.input.getY());
    Actor actor=stage.hit(stageCoords.x,stageCoords.y);
    if (actor instanceof Image)     ((Image)actor).setColor((float)Math.random(),(float)Math.random(),(float)Math.random(),0.5f + 0.5f * (float)Math.random());
  }
  Array<Actor> actors=stage.getActors();
  int len=actors.size;
  for (int i=0; i < len; i++)   if (rotateSprites)   actors.get(i).rotate(Gdx.graphics.getDeltaTime());
 else   actors.get(i).setRotation(0);
  scale+=vScale * Gdx.graphics.getDeltaTime();
  if (scale > 1) {
    scale=1;
    vScale=-vScale;
  }
  if (scale < 0.5f) {
    scale=0.5f;
    vScale=-vScale;
  }
  len=images.size();
  for (int i=0; i < len; i++) {
    Image img=images.get(i);
    if (rotateSprites)     img.rotate(-40 * Gdx.graphics.getDeltaTime());
 else     img.setRotation(0);
    if (scaleSprites) {
      img.setScale(scale);
    }
 else {
      img.setScale(1);
    }
    img.invalidate();
  }
  stage.draw();
  renderer.begin(ShapeType.Point);
  renderer.setColor(1,0,0,1);
  len=actors.size;
  for (int i=0; i < len; i++) {
    Group group=(Group)actors.get(i);
    renderer.point(group.getX() + group.getOriginX(),group.getY() + group.getOriginY(),0);
  }
  renderer.end();
  ((Label)ui.findActor("fps")).setText("fps: " + Gdx.graphics.getFramesPerSecond() + ", actors "+ images.size()+ ", groups "+ actors.size);
  ui.draw();
}
