{
  for (int i=0; i < materialsWithShader.size; i++) {
    if (material.shaderEquals(materialsWithShader.items[i])) {
      material.shader=materialsWithShader.items[i].shader;
      return material.shader;
    }
  }
  material.shader=ShaderFactory.createShader(material,lightManager);
  materialsWithShader.add(material);
  return material.shader;
}
