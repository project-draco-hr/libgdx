{
  int result=-1;
  int weight=textureWeights[0];
  int windex=0;
  for (int i=0; i < textureCount; i++) {
    if (textures[i] == texture) {
      result=i;
      textureWeights[i]++;
    }
 else     if (--textureWeights[i] < weight || textureWeights[i] < 0) {
      weight=textureWeights[i];
      windex=i;
    }
  }
  if (result < 0) {
    textures[windex]=texture;
    textureWeights[windex]=100;
    result=windex;
    texture.bind(textureUnitOffset + windex);
    bindCount++;
  }
 else   reuseCount++;
  return textureUnitOffset + result;
}
