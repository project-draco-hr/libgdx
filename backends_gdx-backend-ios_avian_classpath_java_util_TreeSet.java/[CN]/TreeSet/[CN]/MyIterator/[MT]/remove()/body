{
  if (!canRemove)   throw new IllegalStateException();
  --size;
  if (prevPrevCell != null && prevPrevCell.next == prevCell) {
    prevPrevCell.next=prevCell.next;
    prevCell=prevPrevCell;
  }
 else   if (prevCell.next == cell && cell != null) {
    set=(PersistentSet)path.replaceWith(cell);
    prevCell=null;
  }
 else {
    set=(PersistentSet)path.remove();
    path=path.successor();
    if (path != null) {
      prevCell=null;
      cell=path.value();
      path=(PersistentSet.Path)set.find((Cell)cell);
    }
  }
  canRemove=false;
}
