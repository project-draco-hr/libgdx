{
  reset();
  StringBuilder sb=null;
  int index=0;
  int count=0;
  while (count < limit && index < input.length()) {
    if (find(index)) {
      if (sb == null) {
        sb=new StringBuilder();
      }
      if (start > index) {
        sb.append(input.subSequence(index,start));
      }
      sb.append(replacement);
      index=end;
      ++count;
    }
 else     if (index == 0) {
      return input.toString();
    }
 else {
      break;
    }
  }
  if (index < input.length()) {
    sb.append(input.subSequence(index,input.length()));
  }
  return sb.toString();
}
