{
  forceExit=config.forceExit;
  final Thread glThread=Thread.currentThread();
  GdxNativesLoader.load();
  boolean inputCallbacksOnAppKitThread=isMac;
  if (inputCallbacksOnAppKitThread)   java.awt.Toolkit.getDefaultToolkit();
  if (!glfwInit())   throw new GdxRuntimeException("Unable to initialize GLFW.");
  Gdx.app=this;
  Gdx.graphics=graphics=new JglfwGraphics(config);
  Gdx.files=files=new JglfwFiles();
  Gdx.input=input=new JglfwInput(this,inputCallbacksOnAppKitThread);
  Gdx.net=net=new JglfwNet();
  callbacks.add(new GlfwCallbackAdapter(){
    public void windowSize(    long window,    final int width,    final int height){
      Runnable runnable=new Runnable(){
        public void run(){
          graphics.resized(width,height);
        }
      }
;
      if (Thread.currentThread() != glThread)       postRunnable(runnable);
 else       runnable.run();
    }
    public void windowPos(    long window,    final int x,    final int y){
      Runnable runnable=new Runnable(){
        public void run(){
          graphics.x=x;
          graphics.y=y;
        }
      }
;
      if (Thread.currentThread() != glThread)       postRunnable(runnable);
 else       runnable.run();
    }
    public void windowRefresh(    long window){
      if (Thread.currentThread() == glThread)       render();
    }
    public void error(    int error,    String description){
      throw new GdxRuntimeException("GLFW error " + error + ": "+ description);
    }
  }
);
  glfwSetCallback(callbacks);
  listener.create();
  listener.resize(graphics.getWidth(),graphics.getHeight());
  if (config.runOnEDT) {
    new Runnable(){
      public void run(){
        frame();
        if (running)         EventQueue.invokeLater(this);
 else         end();
      }
    }
.run();
  }
 else {
    while (running)     frame();
    end();
  }
}
