{
  if (!running)   return;
  if (executeRunnables())   graphics.requestRendering();
  if (!running)   return;
  input.update();
  long frameStartTime=System.nanoTime();
  int targetFPS=(graphics.isHidden() || graphics.isMinimized()) ? hiddenFPS : (graphics.isForeground() ? foregroundFPS : backgroundFPS);
  if (targetFPS == -1) {
    if (!isPaused)     listener.pause();
    isPaused=true;
  }
 else {
    if (isPaused)     listener.resume();
    isPaused=false;
    if (graphics.shouldRender())     render(frameStartTime);
  }
  if (targetFPS != 0) {
    if (targetFPS == -1)     sleep(100);
 else     Sync.sync(targetFPS);
  }
}
